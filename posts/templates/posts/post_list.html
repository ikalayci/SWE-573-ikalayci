<h2>Posts</h2>

<!-- Display login/logout/register options based on user's authentication status -->
{% if user.is_authenticated %}
    <p>Welcome, {{ user.username }}!</p>
    <a href="{% url 'logout' %}" class="button cancel-button">Logout</a>
    <a href="{% url 'create_post' %}" class="button main-button">Add Post</a>
{% else %}
    <a href="{% url 'login' %}" class="button main-button">Login</a>
    <a href="{% url 'register' %}" class="button main-button">Register</a>
{% endif %}

{% for post in posts %}
    <div>
        <strong>{{ post.user.username }}</strong>
        <p>{{ post.content }}</p>
        <small>Posted on {{ post.created_at }}</small>

        {% if post.image %}
            <div>
                <img src="{{ post.image.url }}" alt="Image for {{ post.content }}" style="max-width: 100%; height: auto;">
            </div>
        {% endif %}

        <!-- Display tags if available -->
        {% if post.tags.exists %}
            <p><strong>Tags:</strong>
                {% for tag in post.tags.all %}
                    <a href="{% url 'tag_detail' tag.name %}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
            </p>
        {% endif %}

        <h4>Comments:</h4>
        {% for comment in post.comments.all %}
            <div style="margin-left: 20px;">
                <p>
                    <strong>
                        {% if comment.user %}
                            {{ comment.user.username }}
                        {% else %}
                            Anonymous
                        {% endif %}
                    </strong>: {{ comment.content }}
                </p>
                <small>Commented on {{ comment.created_at }}</small>
            </div>
        {% empty %}
            <p style="margin-left: 20px;">No comments yet.</p>
        {% endfor %}

        <!-- Comment form -->
        <form action="{% url 'add_comment' post.id %}" method="post" style="margin-top: 10px;">
            {% csrf_token %}
            <textarea name="content" rows="2" placeholder="Add a comment..." required></textarea>
            <button type="submit" class="button main-button">Comment</button>
        </form>
    </div>
    <hr>
{% empty %}
    <p>No posts yet. Be the first to <a href="{% url 'create_post' %}" class="button main-button">create one</a>!</p>
{% endfor %}


<style>
    /* Common button styles */
    .button {
        display: inline-block;
        padding: 8px 16px;
        margin-top: 10px;
        font-size: 16px;
        color: #fff;
        border: none;
        border-radius: 4px;
        text-decoration: none;
        cursor: pointer;
    }

    /* Grey button for main actions (e.g., Add Comment) */
    .button.main-button {
        background-color: #6c757d;  /* Grey color */
    }

    .button.main-button:hover {
        background-color: #5a6268; /* Darker grey on hover */
    }

    /* Red button specifically for cancel actions */
    .button.cancel-button {
        background-color: #d9534f;  /* Red color */
    }

    .button.cancel-button:hover {
        background-color: #c9302c; /* Darker red on hover */
    }
</style>


</body>
</html>
